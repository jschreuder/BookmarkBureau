{
    # Disable automatic HTTPS (typically used behind reverse proxy on NAS)
    auto_https off
    # Disable admin API
    admin off
}

:8080 {
    # Document root is the web directory
    root * /var/www/web

    # Enable compression
    encode gzip

    # API endpoint - route to PHP-FPM (must come before try_files)
    @api {
        path /api.php /api.php/*
    }
    handle @api {
        reverse_proxy unix//var/www/var/run/php-fpm.sock {
            transport fastcgi {
                root /var/www/web
                split .php
            }
        }
    }

    # Angular SPA - serve static files, fallback to index.html for client-side routing
    handle {
        try_files {path} /index.html
        file_server
    }
}
