<div class="search-container">
  <div class="search-header">
    <mat-icon class="search-icon">search</mat-icon>
    <input
      type="text"
      class="search-input"
      placeholder="Search links by title, description, or tags..."
      [(ngModel)]="searchQuery"
      (ngModelChange)="onSearchChange()"
      #searchInput
      autofocus
    />
    <button class="close-button" (click)="close()">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <div class="search-results" *ngIf="searchQuery">
    <div *ngIf="filteredLinks.length === 0" class="no-results">
      <mat-icon>search_off</mat-icon>
      <p>No results found for "{{ searchQuery }}"</p>
    </div>

    <mat-list class="results-list" *ngIf="filteredLinks.length > 0">
      <mat-list-item
        *ngFor="let link of filteredLinks; let i = index"
        class="result-item"
        [class.selected]="i === selectedIndex"
        (click)="selectLink(link)"
        (mouseenter)="selectedIndex = i"
      >
        <mat-icon matListItemIcon *ngIf="link.icon">{{ link.icon }}</mat-icon>
        <mat-icon matListItemIcon *ngIf="!link.icon">link</mat-icon>
        <div matListItemTitle class="result-title">
          <span [innerHTML]="highlightText(link.title)"></span>
        </div>
        <div matListItemLine class="result-meta">
          <span class="result-badges">
            <span
              class="badge"
              *ngIf="link.isFavorite"
              [style.background-color]="'rgb(87, 107, 203)'"
              [style.color]="getTextColor('rgb(87, 107, 203)')"
            >
              <mat-icon class="badge-icon">star</mat-icon>
              FAVORITE
            </span>
            <span
              class="badge"
              *ngIf="link.category"
              [style.background-color]="link.categoryColor || 'rgb(87, 107, 203)'"
              [style.color]="getTextColor(link.categoryColor || 'rgb(87, 107, 203)')"
            >
              {{ link.category.toUpperCase() }}
            </span>
            <span class="tag" *ngFor="let tag of link.tags" [style.color]="tag.color">
              #{{ tag.tag_name }}
            </span>
          </span>
          <span class="result-description" *ngIf="link.description">
            {{ link.description | slice: 0 : 80 }}{{ link.description.length > 80 ? '...' : '' }}
          </span>
        </div>
      </mat-list-item>
    </mat-list>
  </div>

  <div class="search-hint" *ngIf="!searchQuery">
    <p>Start typing to search through all links...</p>
    <div class="keyboard-hints">
      <span class="hint"><kbd>↑</kbd> <kbd>↓</kbd> Navigate</span>
      <span class="hint"><kbd>↵</kbd> Open</span>
      <span class="hint"><kbd>Esc</kbd> Close</span>
    </div>
  </div>
</div>
