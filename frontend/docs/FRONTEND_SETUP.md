# Frontend Setup Guide

This document describes the frontend architecture and setup for the Bookmark Bureau project.

## Architecture Overview

The project uses a **monorepo architecture** with both frontend and backend code in the same repository:

```
BookmarkBureau/
├── frontend/              # Angular application source
│   ├── src/
│   │   ├── app/
│   │   │   ├── admin/            # Admin area (CRUD operations)
│   │   │   ├── dashboard/         # Public dashboard views
│   │   │   ├── core/             # Core services and models
│   │   │   └── shared/           # Shared components
│   │   └── styles.scss           # Global styles with Material theme
│   ├── angular.json              # Angular configuration
│   └── package.json              # Node dependencies
├── web/                   # Build output directory (served by web server)
│   ├── api.php                   # PHP backend entry point
│   ├── .htaccess                 # Apache routing configuration
│   └── (Angular build artifacts) # Generated by build process
└── src/                   # PHP backend source
```

## Key Design Decisions

### 1. Backend Entry Point: api.php
- **Previously**: `web/index.php` served both API and frontend
- **Now**: `web/api.php` is the PHP backend entry point
- All API requests are routed to `/api/*` which maps to `api.php`

### 2. Frontend Build Output
- Angular builds directly into `web/` directory
- `.htaccess` handles routing:
  - `/api/*` → routes to `api.php` (backend)
  - Everything else → routes to `index.html` (Angular SPA)

### 3. Static SPA Architecture
- Frontend is completely static (no server-side rendering)
- Communicates with backend via REST API at `/api/*`
- Uses Angular Material for UI components

## Directory Structure

### Frontend Application Structure

```
frontend/src/app/
├── admin/                          # Admin area (/admin)
│   ├── admin-layout/              # Admin layout with sidebar navigation
│   ├── dashboards/                # Dashboard CRUD
│   ├── categories/                # Category management
│   ├── links/                     # Link management
│   └── tags/                      # Tag management
├── dashboard/                      # Public dashboard views
│   ├── dashboard-list/            # List all dashboards
│   └── dashboard-view/            # View a single dashboard
├── core/                          # Core application logic
│   ├── models/                    # TypeScript interfaces
│   └── services/                  # API service
└── shared/                        # Shared components (future use)
```

### API Models

Located in [frontend/src/app/core/models/index.ts](frontend/src/app/core/models/index.ts):

```typescript
- Dashboard
- Category
- CategoryWithLinks
- Link
- Tag
- Favorite
- FullDashboard (complete dashboard view)
- ApiResponse<T> (wrapper for API responses)
```

### API Service

Located in [frontend/src/app/core/services/api.service.ts](frontend/src/app/core/services/api.service.ts):

The `ApiService` provides methods for all CRUD operations:
- Dashboard operations
- Category operations
- Link operations
- Tag operations
- Link-Tag associations
- Favorite operations

All API calls are made to `/api/*` endpoints and return RxJS Observables.

## Development Workflow

### Initial Setup

```bash
# Install frontend dependencies
cd frontend
npm install
```

### Development Server

Run the Angular development server:

```bash
cd frontend
npm start
# or
ng serve
```

The app will be available at `http://localhost:4200`

**Note**: In development mode, you'll need to proxy API requests to your PHP backend. Create `frontend/proxy.conf.json`:

```json
{
  "/api": {
    "target": "http://localhost:8000",
    "secure": false,
    "changeOrigin": true,
    "logLevel": "debug"
  }
}
```

Then update `package.json`:

```json
{
  "scripts": {
    "start": "ng serve --proxy-config proxy.conf.json"
  }
}
```

### Building for Production

```bash
cd frontend
npm run build
# or
ng build --configuration production
```

This will:
1. Build the Angular application
2. Output all files to `../web/` directory
3. The PHP backend (api.php) and .htaccess will handle routing

### Running Both Frontend and Backend

For production/testing with the built frontend:

```bash
# Build the frontend
cd frontend && npm run build

# Start PHP development server from project root
php -S localhost:8000 -t web
```

Access the application at `http://localhost:8000`

## Routing

### Frontend Routes

- `/` → Redirects to `/dashboard`
- `/dashboard` → List all dashboards
- `/dashboard/:id` → View specific dashboard with categories and favorites
- `/admin` → Admin area (redirects to `/admin/dashboards`)
- `/admin/dashboards` → Manage dashboards
- `/admin/categories` → Manage categories
- `/admin/links` → Manage links
- `/admin/tags` → Manage tags

### Backend API Routes

All backend routes are prefixed with `/api/`:

**Dashboards:**
- `GET /api/:id` → Get full dashboard view
- `POST /api/dashboard` → Create dashboard
- `PUT /api/dashboard/:id` → Update dashboard
- `DELETE /api/dashboard/:id` → Delete dashboard

**Categories:**
- `GET /api/category/:id` → Get category
- `POST /api/category` → Create category
- `PUT /api/category/:id` → Update category
- `DELETE /api/category/:id` → Delete category

**Links:**
- `GET /api/link/:id` → Get link
- `POST /api/link` → Create link
- `PUT /api/link/:id` → Update link
- `DELETE /api/link/:id` → Delete link

**Tags:**
- `GET /api/tag/:tag_name` → Get tag
- `POST /api/tag` → Create tag
- `PUT /api/tag/:tag_name` → Update tag
- `DELETE /api/tag/:tag_name` → Delete tag

**Link-Tag Associations:**
- `POST /api/link/:id/tag` → Assign tag to link
- `DELETE /api/link/:id/tag/:tag_name` → Remove tag from link

**Favorites:**
- `POST /api/dashboard/:id/favorites` → Add favorite
- `DELETE /api/dashboard/:id/favorites` → Remove favorite
- `PUT /api/dashboard/:id/favorites` → Reorder favorites

## Angular Material Theme

The application uses a custom Angular Material theme defined in [frontend/src/styles.scss](frontend/src/styles.scss):

- **Primary**: Indigo palette
- **Accent**: Pink palette
- **Warn**: Red palette

You can customize the theme by modifying the palette definitions in `styles.scss`.

## Admin Area

The admin area (`/admin`) provides a full CRUD interface for managing:

1. **Dashboards** - Create, view, edit, and delete dashboards
2. **Categories** - Manage categories within dashboards
3. **Links** - Manage bookmarks/links
4. **Tags** - Manage tags and tag-link associations

The admin layout includes:
- Sidebar navigation
- Material Design components
- Responsive design

## Next Steps

The current setup provides the scaffolding. To complete the implementation:

### Required Implementations

1. **Dashboard List Component** - Fetch and display all dashboards
2. **Dashboard View Component** - Display full dashboard with categories and favorites
3. **Admin CRUD Forms** - Implement create/edit forms for each entity
4. **Admin List Views** - Display tables with edit/delete actions
5. **Authentication** - Add login and session management (if needed)

### Optional Enhancements

1. **Drag-and-Drop** - For reordering favorites and categories
2. **Search Functionality** - Search links and tags
3. **Filtering** - Filter links by tags
4. **Error Handling** - Global error interceptor
5. **Loading States** - Show spinners during API calls
6. **Confirmation Dialogs** - Confirm delete actions

## Technology Stack

- **Frontend Framework**: Angular 20+
- **UI Framework**: Angular Material
- **HTTP Client**: Angular HttpClient
- **State Management**: None (can add NgRx/Signals if needed)
- **Build Tool**: Angular CLI with esbuild
- **Styling**: SCSS with Angular Material theming

## Browser Support

The application targets modern browsers:
- Chrome (latest)
- Firefox (latest)
- Safari (latest)
- Edge (latest)

## Performance Considerations

- **Lazy Loading**: Routes are lazy-loaded for optimal bundle size
- **Standalone Components**: All components are standalone (no NgModules)
- **Tree-Shaking**: Unused code is automatically removed during build
- **AOT Compilation**: Ahead-of-time compilation enabled for production

## Troubleshooting

### Build Errors

If you encounter build errors:

```bash
# Clear Angular cache
cd frontend
rm -rf .angular node_modules
npm install
```

### API Not Working

1. Check that `api.php` exists in `web/` directory
2. Verify `.htaccess` file is present and mod_rewrite is enabled
3. Check browser console for CORS errors
4. Verify PHP backend is running

### Routing Issues

If Angular routing doesn't work after build:
1. Verify `.htaccess` is present in `web/` directory
2. Ensure Apache `mod_rewrite` is enabled
3. Check Apache error logs

## Additional Resources

- [Angular Documentation](https://angular.dev)
- [Angular Material](https://material.angular.io)
- [Angular CLI](https://angular.dev/tools/cli)
- [RxJS Documentation](https://rxjs.dev)
